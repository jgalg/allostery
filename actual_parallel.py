"""
each alldict is a dictionary of residues close enough to each residue entry (< 6 angstroms)\
alldict uses alpha carbons
real_alldict was computed using cpp traj
update_alldict is the smaller version of real_alldict that is used when 20 res are randomly chosen

"""
import numpy as np
import random
import time
from multiprocessing import Pool
start_time = time.time()

res_dict = {301: (59.665, 65.467, 44.936), 302: (55.93, 65.46, 44.229), 303: (56.331, 62.061, 42.559),
            304: (56.648, 60.478, 45.98), 305: (53.376, 61.897, 47.293), 306: (50.281, 59.726, 47.039),
            307: (47.884, 60.523, 44.205), 308: (44.453, 61.495, 45.625), 309: (42.015, 58.605, 45.252),
            310: (38.781, 60.422, 46.12), 311: (36.424, 61.714, 43.38), 312: (37.164, 65.134, 41.906),
            313: (35.106, 67.556, 39.831), 314: (36.863, 68.917, 36.75), 315: (35.31, 71.661, 34.656),
            316: (36.777, 71.904, 31.194), 317: (35.985, 74.788, 28.874), 318: (36.759, 73.5, 25.382),
            319: (34.343, 75.466, 23.251), 320: (34.067, 73.521, 20.007), 321: (37.271, 71.539, 20.183),
            322: (38.077, 68.031, 21.349), 323: (38.665, 67.403, 25.048), 324: (42.097, 66.074, 24.204),
            325: (42.118, 62.62, 25.768), 326: (41.581, 58.931, 25.006), 327: (39.198, 56.557, 26.771),
            328: (39.273, 52.761, 27.077), 329: (36.783, 50.366, 28.669), 330: (33.008, 50.253, 28.503),
            331: (32.897, 46.532, 27.828), 332: (30.945, 44.453, 30.318), 333: (30.996, 46.798, 33.307),
            334: (34.694, 47.77, 33.473), 335: (34.038, 51.524, 33.501), 336: (35.446, 54.372, 31.379),
            337: (39.117, 55.245, 31.915), 338: (41.461, 57.885, 30.544), 339: (44.297, 56.135, 28.727),
            340: (46.02, 59.17, 27.275), 341: (46.12, 62.93, 27.712), 342: (47.065, 64.95, 24.641),
            343: (49.792, 67.547, 25.118), 344: (48.321, 71.013, 24.702), 345: (44.717, 69.869, 24.729),
            346: (41.964, 71.279, 27.015), 347: (42.251, 68.286, 29.368), 348: (46.016, 68.817, 29.667),
            349: (45.625, 72.583, 30.232), 350: (43.166, 71.787, 33.038), 351: (45.997, 69.965, 34.795),
            352: (43.35, 68.045, 36.734), 353: (43.054, 64.801, 34.76), 354: (45.478, 61.945, 34.183),
            355: (45.839, 58.476, 32.712), 356: (44.248, 55.956, 35.077), 357: (41.395, 58.307, 35.979),
            358: (37.932, 56.804, 35.639), 359: (35.24, 59.123, 34.296), 360: (32.382, 58.689, 36.753),
            361: (30.157, 61.152, 34.922), 362: (29.993, 63.942, 32.365), 363: (27.661, 66.867, 33.045),
            364: (25.691, 64.84, 35.583), 365: (25.379, 61.823, 33.293), 366: (26.561, 58.703, 35.128),
            367: (29.138, 56.895, 32.996), 368: (30.177, 54.231, 35.509), 369: (28.342, 51.546, 33.558),
            370: (28.394, 53.135, 30.113), 371: (29.336, 51.204, 26.977), 372: (32.359, 52.42, 25.025),
            373: (30.622, 54.215, 22.159), 374: (27.838, 55.741, 24.278), 375: (30.503, 57.106, 26.674),
            376: (32.385, 58.557, 23.71), 377: (29.158, 60.025, 22.344), 378: (28.404, 61.503, 25.769),
            379: (31.804, 63.228, 25.952), 380: (31.907, 64.421, 22.343), 381: (28.397, 65.829, 22.627),
            382: (28.873, 67.083, 26.176), 383: (28.766, 70.727, 25.121), 384: (31.27, 73.584, 25.403),
            385: (31.628, 73.418, 29.181), 386: (32.252, 69.855, 30.316), 387: (31.946, 68.973, 33.99),
            388: (33.594, 65.662, 34.701), 389: (33.616, 63.785, 37.996), 390: (36.755, 61.676, 37.842),
            391: (38.361, 59.164, 40.178), 392: (41.872, 57.723, 40.049), 393: (41.723, 53.896, 39.75),
            394: (45.264, 52.832, 38.686), 395: (44.8, 49.174, 39.578), 396: (41.717, 48.951, 37.425),
            397: (43.361, 50.932, 34.651), 398: (46.576, 48.939, 34.679), 399: (44.558, 45.976, 33.373),
            400: (44.266, 47.64, 29.947), 401: (47.847, 48.649, 29.176), 402: (50.436, 45.955, 28.589),
            403: (53.231, 45.553, 31.156), 404: (51.719, 48.17, 33.461), 405: (51.465, 48.155, 37.249),
            406: (51.014, 50.518, 40.183), 407: (53.804, 51.643, 42.503), 408: (53.624, 52.489, 46.219),
            409: (52.541, 56.084, 45.545), 410: (49.81, 54.94, 43.176), 411: (51.712, 55.857, 40.022),
            412: (51.036, 53.761, 36.933), 413: (54.37, 52.309, 35.812), 414: (54.872, 50.526, 32.52),
            415: (57.787, 48.123, 31.992)}

res_dict2 = {301: (59.665, 65.467, 44.936), 302: (55.93, 65.46, 44.229), 303: (56.331, 62.061, 42.559),
            304: (56.648, 60.478, 45.98), 305: (53.376, 61.897, 47.293), 306: (50.281, 59.726, 47.039),
            307: (47.884, 60.523, 44.205), 308: (44.453, 61.495, 45.625), 309: (42.015, 58.605, 45.252),
            310: (38.781, 60.422, 46.12), 311: (36.424, 61.714, 43.38), 312: (37.164, 65.134, 41.906),
            314: (36.863, 68.917, 36.75), 315: (35.31, 71.661, 34.656),
            316: (36.777, 71.904, 31.194), 317: (35.985, 74.788, 28.874), 318: (36.759, 73.5, 25.382),
            319: (34.343, 75.466, 23.251), 320: (34.067, 73.521, 20.007), 321: (37.271, 71.539, 20.183),
            322: (38.077, 68.031, 21.349), 323: (38.665, 67.403, 25.048), 324: (42.097, 66.074, 24.204),
            325: (42.118, 62.62, 25.768), 326: (41.581, 58.931, 25.006), 327: (39.198, 56.557, 26.771),
            328: (39.273, 52.761, 27.077), 329: (36.783, 50.366, 28.669), 330: (33.008, 50.253, 28.503),
            331: (32.897, 46.532, 27.828), 332: (30.945, 44.453, 30.318), 333: (30.996, 46.798, 33.307),
            334: (34.694, 47.77, 33.473), 335: (34.038, 51.524, 33.501), 336: (35.446, 54.372, 31.379),
            337: (39.117, 55.245, 31.915), 338: (41.461, 57.885, 30.544), 339: (44.297, 56.135, 28.727),
            340: (46.02, 59.17, 27.275), 341: (46.12, 62.93, 27.712), 342: (47.065, 64.95, 24.641),
            343: (49.792, 67.547, 25.118), 344: (48.321, 71.013, 24.702), 345: (44.717, 69.869, 24.729),
            346: (41.964, 71.279, 27.015), 347: (42.251, 68.286, 29.368), 348: (46.016, 68.817, 29.667),
            349: (45.625, 72.583, 30.232), 350: (43.166, 71.787, 33.038), 351: (45.997, 69.965, 34.795),
            352: (43.35, 68.045, 36.734), 353: (43.054, 64.801, 34.76), 354: (45.478, 61.945, 34.183),
            355: (45.839, 58.476, 32.712), 356: (44.248, 55.956, 35.077), 357: (41.395, 58.307, 35.979),
            358: (37.932, 56.804, 35.639), 359: (35.24, 59.123, 34.296), 360: (32.382, 58.689, 36.753),
            361: (30.157, 61.152, 34.922), 362: (29.993, 63.942, 32.365), 363: (27.661, 66.867, 33.045),
            364: (25.691, 64.84, 35.583), 365: (25.379, 61.823, 33.293), 366: (26.561, 58.703, 35.128),
            367: (29.138, 56.895, 32.996), 368: (30.177, 54.231, 35.509), 369: (28.342, 51.546, 33.558),
            370: (28.394, 53.135, 30.113), 371: (29.336, 51.204, 26.977), 372: (32.359, 52.42, 25.025),
            373: (30.622, 54.215, 22.159), 374: (27.838, 55.741, 24.278), 375: (30.503, 57.106, 26.674),
            377: (29.158, 60.025, 22.344), 378: (28.404, 61.503, 25.769),
            379: (31.804, 63.228, 25.952), 380: (31.907, 64.421, 22.343), 381: (28.397, 65.829, 22.627),
            382: (28.873, 67.083, 26.176), 383: (28.766, 70.727, 25.121), 384: (31.27, 73.584, 25.403),
            385: (31.628, 73.418, 29.181), 386: (32.252, 69.855, 30.316), 387: (31.946, 68.973, 33.99),
            388: (33.594, 65.662, 34.701), 389: (33.616, 63.785, 37.996), 390: (36.755, 61.676, 37.842),
            391: (38.361, 59.164, 40.178), 392: (41.872, 57.723, 40.049), 393: (41.723, 53.896, 39.75),
            394: (45.264, 52.832, 38.686), 395: (44.8, 49.174, 39.578), 396: (41.717, 48.951, 37.425),
            397: (43.361, 50.932, 34.651), 398: (46.576, 48.939, 34.679), 399: (44.558, 45.976, 33.373),
            400: (44.266, 47.64, 29.947), 401: (47.847, 48.649, 29.176), 402: (50.436, 45.955, 28.589),
            403: (53.231, 45.553, 31.156), 404: (51.719, 48.17, 33.461), 405: (51.465, 48.155, 37.249),
            406: (51.014, 50.518, 40.183), 407: (53.804, 51.643, 42.503), 408: (53.624, 52.489, 46.219),
            409: (52.541, 56.084, 45.545), 410: (49.81, 54.94, 43.176), 411: (51.712, 55.857, 40.022),
            412: (51.036, 53.761, 36.933), 413: (54.37, 52.309, 35.812), 414: (54.872, 50.526, 32.52),
            415: (57.787, 48.123, 31.992)}

# Distance criterion < 6 Ã… - using distance (Amber12) - from center of mass
# real_alldict = {301: [302], 302: [303, 305, 301], 303: [304, 305, 411, 302], 304: [305, 303],
#  305: [306, 302, 303, 304], 306: [307, 409, 305], 307: [308, 392, 410, 411, 306], 308: [309, 307],
#  309: [392, 308], 310: [311], 311: [312, 390, 391, 310], 312: [390, 311], 313: [314], 314: [315, 352, 388, 313],
#  315: [316, 317, 386, 387, 314], 316: [317, 386, 315], 317: [385, 315, 316],
#  318: [319, 320, 321, 322, 323, 383, 384], 319: [320, 321, 384, 318], 320: [321, 318, 319],
#  321: [322, 318, 319, 320], 322: [323, 324, 318, 321], 323: [324, 325, 346, 318, 322],
#  324: [325, 342, 345, 346, 347, 322, 323], 325: [326, 338, 323, 324], 326: [327, 339, 340, 325],
#  327: [328, 326], 328: [329, 337, 339, 400, 327], 329: [330, 331, 335, 336, 372, 328],
#  330: [331, 333, 335, 370, 371, 372, 329], 331: [332, 329, 330], 332: [333, 331], 333: [334, 335, 369, 330, 332],
#  334: [335, 333], 335: [336, 337, 329, 330, 333, 334], 336: [337, 358, 359, 329, 335], 337: [338, 356, 358, 397, 328, 335, 336],
#  338: [339, 355, 356, 357, 325, 337], 339: [340, 355, 326, 328, 338], 340: [341, 342, 326, 339], 341: [342, 340], 342: [343, 344, 345, 324, 340, 341],
#  343: [344, 345, 348, 342], 344: [345, 348, 349, 342, 343], 345: [346, 347, 348, 349, 324, 342, 343, 344],
#  346: [347, 349, 323, 324, 345], 347: [348, 349, 350, 353, 324, 345, 346], 348: [349, 350, 343, 344, 345, 347], 349: [350, 344, 345, 346, 347, 348],
#  350: [351, 352, 347, 348, 349], 351: [352, 353, 350],
#  352: [353, 314, 350, 351], 353: [347, 351, 352], 354: [355, 357], 355: [356, 397, 412, 338, 339, 354],
#  356: [357, 392, 394, 397, 337, 338, 355], 357: [358, 390, 392, 338, 354, 356],
#  358: [359, 360, 391, 393, 336, 337, 357], 359: [360, 361, 367, 390, 336, 358],
#  360: [361, 368, 389, 390, 358, 359], 361: [362, 364, 365, 366, 367, 388, 389, 359, 360],
#  362: [363, 364, 365, 388, 361], 363: [364, 365, 382, 386, 387, 362], 364: [365, 361, 362, 363],
#  365: [366, 367, 361, 362, 363, 364], 366: [367, 368, 361, 365], 367: [370, 375, 359, 361, 365, 366],
#  368: [369, 360, 366], 369: [370, 333, 368], 370: [371, 330, 367, 369], 371: [372, 374, 375, 330, 370],
#  372: [373, 375, 329, 330, 371], 373: [374, 376, 377, 372], 374: [375, 377, 371, 373],
#  375: [376, 377, 378, 379, 367, 371, 372, 374], 376: [377, 378, 379, 380, 373, 375],
#  377: [378, 380, 381, 373, 374, 375, 376], 378: [379, 381, 382, 375, 376, 377], 379: [380, 375, 376, 378],
#  380: [381, 376, 377, 379], 381: [382, 377, 378, 380], 382: [383, 386, 363, 378, 381],
#  383: [384, 385, 386, 318, 382], 384: [385, 318, 319, 383], 385: [386, 317, 383, 384],
#  386: [387, 388, 315, 316, 363, 382, 383, 385], 387: [388, 315, 363, 386], 388: [389, 314, 361, 362, 386, 387],
#  389: [390, 360, 361, 388], 390: [391, 311, 312, 357, 359, 360, 389], 391: [393, 311, 358, 390],
#  392: [393, 394, 307, 309, 356, 357], 393: [394, 396, 358, 391, 392], 394: [395, 396, 406, 356, 392, 393], 395: [396, 406, 394], 396: [393, 394, 395],
#  397: [398, 400, 401, 337, 355, 356], 398: [399, 404, 397], 399: [400, 398], 400: [328, 397, 399], 401: [402, 404, 397], 402: [403, 404, 401],
#  403: [404, 414, 415, 402], 404: [405, 414, 398, 401, 402, 403], 405: [406, 413, 404], 406: [407, 410, 412, 394, 395, 405], 407: [408, 409, 410, 411, 406],
#  408: [409, 407], 409: [410, 411, 306, 407, 408], 410: [411, 307, 406, 407, 409], 411: [303, 307, 407, 409, 410],
#  412: [413, 355, 406], 413: [414, 405, 412], 414: [415, 403, 404, 413], 415: [403, 414]}

# Distance criterion < 7 Ã… - using distance (Amber12) - from center of mass
# real_alldict = {301: [302, 303, 304, 305], 302: [303, 304, 305, 301], 303: [304, 305, 409, 411, 301, 302],
#  304: [305, 301, 302, 303], 305: [306, 301, 302, 303, 304], 306: [307, 308, 409, 305], 307: [308, 309, 392, 409, 410, 411, 306], 308: [309, 310, 392, 306, 307], 309: [392, 393, 307, 308], 310: [311, 312, 308], 311: [312, 389, 390, 391, 310], 312: [314, 352, 389, 390, 391, 310, 311], 313: [314, 315, 387, 389], 314: [315, 316, 352, 353, 387, 388, 389, 390, 312, 313], 315: [316, 317, 385, 386, 387, 388, 313, 314], 316: [317, 318, 323, 346, 347, 350, 385, 386, 314, 315], 317: [385, 386, 315, 316], 318: [319, 320, 321, 322, 323, 346, 383, 384, 385, 386, 316], 319: [320, 321, 383, 384, 318], 320: [321, 384, 318, 319], 321: [322, 323, 318, 319, 320], 322: [323, 324, 346, 318, 321], 323: [324, 325, 346, 347, 379, 316, 318, 321, 322], 324: [325, 341, 342, 345, 346, 347, 322, 323], 325: [326, 327, 338, 341, 347, 323, 324], 326: [327, 338, 339, 340, 325], 327: [328, 329, 336, 338, 339, 372, 325, 326], 328: [329, 336, 337, 339, 397, 400, 327], 329: [330, 331, 334, 335, 336, 337, 372, 327, 328], 330: [331, 332, 333, 334, 335, 336, 370, 371, 372, 329], 331: [332, 333, 334, 329, 330], 332: [333, 334, 330, 331], 333: [334, 335, 369, 370, 330, 331, 332], 334: [335, 329, 330, 331, 332, 333], 335: [336, 337, 358, 370, 329, 330, 333, 334], 336: [337, 358, 359, 367, 370, 375, 327, 328, 329, 330, 335], 337: [338, 356, 357, 358, 359, 397, 400, 328, 329, 335, 336], 338: [339, 341, 353, 355, 356, 357, 325, 326, 327, 337], 339: [340, 355, 397, 326, 327, 328, 338], 340: [341, 342, 326, 339], 341: [342, 343, 347, 348, 353, 324, 325, 338, 340], 342: [343, 344, 345, 348, 324, 340, 341], 343: [344, 345, 348, 341, 342], 344: [345, 346, 348, 349, 342, 343], 345: [346, 347, 348, 349, 324, 342, 343, 344], 346: [347, 348, 349, 350, 316, 318, 322, 323, 324, 344, 345], 347: [348, 349, 350, 351, 353, 316, 323, 324, 325, 341, 345, 346], 348: [349, 350, 351, 341, 342, 343, 344, 345, 346, 347], 349: [350, 351, 344, 345, 346, 347, 348], 350: [351, 352, 353, 316, 346, 347, 348, 349], 351: [352, 353, 347, 348, 349, 350], 352: [353, 312, 314, 350, 351], 353: [354, 357, 314, 338, 341, 347, 350, 351, 352], 354: [355, 356, 357, 392, 353], 355: [356, 397, 412, 338, 339, 354], 356: [357, 392, 393, 394, 397, 337, 338, 354, 355], 357: [358, 359, 390, 391, 392, 337, 338, 353, 354, 356], 358: [359, 360, 390, 391, 393, 335, 336, 337, 357], 359: [360, 361, 367, 388, 389, 390, 336, 337, 357, 358], 360: [361, 366, 367, 368, 389, 390, 391, 358, 359], 361: [362, 363, 364, 365, 366, 367, 388, 389, 359, 360], 362: [363, 364, 365, 367, 378, 379, 382, 386, 387, 388, 361], 363: [364, 365, 382, 386, 387, 361, 362], 364: [365, 366, 361, 362, 363], 365: [366, 367, 361, 362, 363, 364], 366: [367, 368, 369, 360, 361, 364, 365], 367: [368, 369, 370, 375, 336, 359, 360, 361, 362, 365, 366], 368: [369, 360, 366, 367], 369: [370, 333, 366, 367, 368], 370: [371, 375, 330, 333, 335, 336, 367, 369], 371: [372, 373, 374, 375, 330, 370], 372: [373, 375, 376, 327, 329, 330, 371], 373: [374, 375, 376, 377, 371, 372], 374: [375, 376, 377, 378, 371, 373], 375: [376, 377, 378, 379, 336, 367, 370, 371, 372, 373, 374], 376: [377, 378, 379, 380, 372, 373, 374, 375], 377: [378, 379, 380, 381, 373, 374, 375, 376], 378: [379, 380, 381, 382, 362, 374, 375, 376, 377], 379: [380, 381, 382, 323, 362, 375, 376, 377, 378], 380: [381, 376, 377, 378, 379], 381: [382, 383, 377, 378, 379, 380], 382: [383, 386, 362, 363, 378, 379, 381], 383: [384, 385, 386, 318, 319, 381, 382], 384: [385, 318, 319, 320, 383], 385: [386, 387, 315, 316, 317, 318, 383, 384], 386: [387, 388, 315, 316, 317, 318, 362, 363, 382, 383, 385], 387: [388, 389, 313, 314, 315, 362, 363, 385, 386], 388: [389, 390, 314, 315, 359, 361, 362, 386, 387], 389: [390, 311, 312, 313, 314, 359, 360, 361, 387, 388], 390: [391, 311, 312, 314, 357, 358, 359, 360, 388, 389], 391: [392, 393, 311, 312, 357, 358, 360, 390], 392: [393, 394, 410, 307, 308, 309, 354, 356, 357, 391], 393: [394, 395, 396, 309, 356, 358, 391, 392], 394: [395, 396, 397, 398, 406, 410, 412, 356, 392, 393], 395: [396, 398, 406, 393, 394], 396: [398, 399, 393, 394, 395], 397: [398, 400, 401, 412, 328, 337, 339, 355, 356, 394], 398: [399, 400, 401, 404, 394, 395, 396, 397], 399: [400, 396, 398], 400: [401, 328, 337, 397, 398, 399], 401: [402, 403, 404, 414, 397, 398, 400], 402: [403, 404, 414, 401], 403: [404, 414, 415, 401, 402], 404: [405, 412, 413, 414, 415, 398, 401, 402, 403], 405: [406, 407, 413, 414, 415, 404], 406: [407, 410, 412, 413, 394, 395, 405], 407: [408, 409, 410, 411, 413, 405, 406], 408: [409, 410, 407], 409: [410, 411, 303, 306, 307, 407, 408], 410: [411, 412, 307, 392, 394, 406, 407, 408, 409], 411: [412, 303, 307, 407, 409, 410], 412: [413, 355, 394, 397, 404, 406, 410, 411], 413: [414, 415, 404, 405, 406, 407, 412], 414: [415, 401, 402, 403, 404, 405, 413], 415: [403, 404, 405, 413, 414]}

# Distance criterion < 8 Ã… - using distance (Amber12) - from center of mass
# real_alldict = {301: [302, 303, 304, 305], 302: [303, 304, 305, 301], 303: [304, 305, 409, 411, 301, 302],
#  304: [305, 409, 301, 302, 303], 305: [306, 307, 409, 301, 302, 303, 304],
#   306: [307, 308, 408, 409, 410, 411, 305], 307: [308, 309, 354, 392, 409, 410, 411, 305, 306], 308: [309, 310, 312, 392, 306, 307], 309: [310, 391, 392, 393, 394, 410, 307, 308],
#    310: [311, 312, 391, 308, 309], 311: [312, 389, 390, 391, 310], 312: [313, 314, 352, 353, 357, 389, 390, 391, 308, 310, 311], 313: [314, 315, 387, 388, 389, 312], 314: [315, 316, 350, 352, 353, 386, 387, 388, 389, 390, 312, 313], 315: [316, 317, 352, 385, 386, 387, 388, 313, 314], 316: [317, 318, 323, 346, 347, 350, 385, 386, 387, 388, 314, 315], 317: [318, 319, 384, 385, 386, 315, 316], 318: [319, 320, 321, 322, 323, 346, 382, 383, 384, 385, 386, 316, 317], 319: [320, 321, 322, 383, 384, 385, 317, 318], 320: [321, 322, 383, 384, 318, 319], 321: [322, 323, 346, 318, 319, 320], 322: [323, 324, 345, 346, 318, 319, 320, 321], 323: [324, 325, 345, 346, 347, 379, 386, 316, 318, 321, 322], 324: [325, 326, 340, 341, 342, 343, 344, 345, 346, 347, 348, 322, 323], 325: [326, 327, 338, 339, 340, 341, 342, 347, 353, 379, 323, 324], 326: [327, 328, 338, 339, 340, 341, 324, 325], 327: [328, 329, 336, 337, 338, 339, 372, 375, 376, 325, 326], 328: [329, 330, 335, 336, 337, 338, 339, 372, 397, 400, 326, 327], 329: [330, 331, 333, 334, 335, 336, 337, 370, 371, 372, 400, 327, 328], 330: [331, 332, 333, 334, 335, 336, 370, 371, 372, 328, 329], 331: [332, 333, 334, 335, 371, 372, 329, 330], 332: [333, 334, 330, 331], 333: [334, 335, 369, 370, 329, 330, 331, 332], 334: [335, 337, 396, 399, 400, 329, 330, 331, 332, 333], 335: [336, 337, 358, 367, 369, 370, 328, 329, 330, 331, 333, 334], 336: [337, 338, 358, 359, 360, 367, 370, 372, 375, 327, 328, 329, 330, 335], 337: [338, 339, 356, 357, 358, 359, 393, 396, 397, 400, 327, 328, 329, 334, 335, 336], 338: [339, 340, 341, 353, 354, 355, 356, 357, 358, 359, 397, 325, 326, 327, 328, 336, 337], 339: [340, 341, 355, 356, 397, 401, 325, 326, 327, 328, 337, 338], 340: [341, 342, 355, 324, 325, 326, 338, 339], 341: [342, 343, 345, 347, 348, 353, 354, 355, 324, 325, 326, 338, 339, 340], 342: [343, 344, 345, 346, 347, 348, 324, 325, 340, 341], 343: [344, 345, 348, 324, 341, 342], 344: [345, 346, 347, 348, 349, 324, 342, 343], 345: [346, 347, 348, 349, 322, 323, 324, 341, 342, 343, 344], 346: [347, 348, 349, 350, 316, 318, 321, 322, 323, 324, 342, 344, 345], 347: [348, 349, 350, 351, 352, 353, 316, 323, 324, 325, 341, 342, 344, 345, 346], 348: [349, 350, 351, 353, 324, 341, 342, 343, 344, 345, 346, 347], 349: [350, 351, 344, 345, 346, 347, 348], 350: [351, 352, 353, 314, 316, 346, 347, 348, 349], 351: [352, 353, 347, 348, 349, 350], 352: [353, 312, 314, 315, 347, 350, 351], 353: [354, 357, 388, 390, 312, 314, 325, 338, 341, 347, 348, 350, 351, 352], 354: [355, 356, 357, 392, 307, 338, 341, 353], 355: [356, 357, 397, 401, 412, 338, 339, 340, 341, 354], 356: [357, 358, 392, 393, 394, 397, 412, 337, 338, 339, 354, 355], 357: [358, 359, 390, 391, 392, 393, 312, 337, 338, 353, 354, 355, 356], 358: [359, 360, 368, 390, 391, 393, 335, 336, 337, 338, 356, 357], 359: [360, 361, 362, 367, 388, 389, 390, 336, 337, 338, 357, 358], 360: [361, 366, 367, 368, 388, 389, 390, 391, 336, 358, 359], 361: [362, 363, 364, 365, 366, 367, 387, 388, 389, 390, 359, 360], 362: [363, 364, 365, 366, 367, 378, 379, 382, 386, 387, 388, 389, 359, 361], 363: [364, 365, 382, 383, 385, 386, 387, 388, 361, 362], 364: [365, 366, 387, 389, 361, 362, 363], 365: [366, 367, 378, 361, 362, 363, 364], 366: [367, 368, 369, 370, 360, 361, 362, 364, 365], 367: [368, 369, 370, 375, 378, 335, 336, 359, 360, 361, 362, 365, 366], 368: [369, 370, 358, 360, 366, 367], 369: [370, 371, 333, 335, 366, 367, 368], 370: [371, 372, 374, 375, 329, 330, 333, 335, 336, 366, 367, 368, 369], 371: [372, 373, 374, 375, 329, 330, 331, 369, 370], 372: [373, 374, 375, 376, 327, 328, 329, 330, 331, 336, 370, 371], 373: [374, 375, 376, 377, 371, 372], 374: [375, 376, 377, 378, 370, 371, 372, 373], 375: [376, 377, 378, 379, 327, 336, 367, 370, 371, 372, 373, 374], 376: [377, 378, 379, 380, 381, 327, 372, 373, 374, 375], 377: [378, 379, 380, 381, 373, 374, 375, 376], 378: [379, 380, 381, 382, 362, 365, 367, 374, 375, 376, 377], 379: [380, 381, 382, 386, 323, 325, 362, 375, 376, 377, 378], 380: [381, 382, 376, 377, 378, 379], 381: [382, 383, 376, 377, 378, 379, 380], 382: [383, 384, 385, 386, 318, 362, 363, 378, 379, 380, 381], 383: [384, 385, 386, 318, 319, 320, 363, 381, 382], 384: [385, 386, 317, 318, 319, 320, 382, 383], 385: [386, 387, 315, 316, 317, 318, 319, 363, 382, 383, 384], 386: [387, 388, 314, 315, 316, 317, 318, 323, 362, 363, 379, 382, 383, 384, 385], 387: [388, 389, 313, 314, 315, 316, 361, 362, 363, 364, 385, 386], 388: [389, 390, 313, 314, 315, 316, 353, 359, 360, 361, 362, 363, 386, 387], 389: [390, 391, 311, 312, 313, 314, 359, 360, 361, 362, 364, 387, 388], 390: [391, 311, 312, 314, 353, 357, 358, 359, 360, 361, 388, 389], 391: [392, 393, 309, 310, 311, 312, 357, 358, 360, 389, 390], 392: [393, 394, 395, 410, 412, 307, 308, 309, 354, 356, 357, 391], 393: [394, 395, 396, 309, 337, 356, 357, 358, 391, 392], 394: [395, 396, 397, 398, 406, 410, 412, 309, 356, 392, 393], 395: [396, 398, 406, 410, 392, 393, 394], 396: [397, 398, 399, 334, 337, 393, 394, 395], 397: [398, 399, 400, 401, 404, 412, 328, 337, 338, 339, 355, 356, 394, 396], 398: [399, 400, 401, 402, 404, 406, 412, 394, 395, 396, 397], 399: [400, 334, 396, 397, 398], 400: [401, 328, 329, 334, 337, 397, 398, 399], 401: [402, 403, 404, 414, 339, 355, 397, 398, 400], 402: [403, 404, 414, 415, 398, 401], 403: [404, 405, 414, 415, 401, 402], 404: [405, 406, 412, 413, 414, 415, 397, 398, 401, 402, 403], 405: [406, 407, 412, 413, 414, 415, 403, 404], 406: [407, 408, 409, 410, 411, 412, 413, 394, 395, 398, 404, 405], 407: [408, 409, 410, 411, 412, 413, 405, 406], 408: [409, 410, 411, 306, 406, 407], 409: [410, 411, 303, 304, 305, 306, 307, 406, 407, 408], 410: [411, 412, 306, 307, 309, 392, 394, 395, 406, 407, 408, 409], 411: [412, 413, 303, 306, 307, 406, 407, 408, 409, 410], 412: [413, 414, 355, 356, 392, 394, 397, 398, 404, 405, 406, 407, 410, 411], 413: [414, 415, 404, 405, 406, 407, 411, 412], 414: [415, 401, 402, 403, 404, 405, 412, 413], 415: [402, 403, 404, 405, 413, 414]}

# Distance criterion < 9 Ã… - using distance (Amber12) - from center of mass
# real_alldict = {301: [302, 303, 304, 305], 302: [303, 304, 305, 301], 303: [304, 305, 306, 307, 407, 409, 411, 301, 302],
#  304: [305, 306, 408, 409, 411, 301, 302, 303], 305: [306, 307, 409, 411, 301, 302, 303, 304], 306: [307, 308, 309, 408, 409, 410, 411, 303, 304, 305], 307: [308, 309, 354, 392, 394, 409, 410, 411, 303, 305, 306], 308: [309, 310, 311, 312, 354, 391, 392, 306, 307], 309: [310, 391, 392, 393, 394, 395, 410, 306, 307, 308], 310: [311, 312, 390, 391, 308, 309], 311: [312, 313, 360, 389, 390, 391, 308, 310], 312: [313, 314, 352, 353, 357, 388, 389, 390, 391, 392, 308, 310, 311], 313: [314, 315, 387, 388, 389, 390, 311, 312], 314: [315, 316, 347, 350, 351, 352, 353, 386, 387, 388, 389, 390, 312, 313], 315: [316, 317, 350, 352, 385, 386, 387, 388, 313, 314], 316: [317, 318, 319, 323, 346, 347, 349, 350, 352, 353, 385, 386, 387, 388, 314, 315], 317: [318, 319, 346, 384, 385, 386, 315, 316], 318: [319, 320, 321, 322, 323, 346, 382, 383, 384, 385, 386, 316, 317], 319: [320, 321, 322, 323, 383, 384, 385, 386, 316, 317, 318], 320: [321, 322, 383, 384, 318, 319], 321: [322, 323, 324, 345, 346, 384, 318, 319, 320], 322: [323, 324, 325, 342, 345, 346, 347, 380, 318, 319, 320, 321], 323: [324, 325, 345, 346, 347, 379, 380, 383, 386, 316, 318, 319, 321, 322], 324: [325, 326, 340, 341, 342, 343, 344, 345, 346, 347, 348, 321, 322, 323], 325: [326, 327, 338, 339, 340, 341, 342, 345, 346, 347, 353, 359, 379, 322, 323, 324], 326: [327, 328, 338, 339, 340, 341, 342, 324, 325], 327: [328, 329, 336, 337, 338, 339, 359, 372, 375, 376, 379, 325, 326], 328: [329, 330, 331, 334, 335, 336, 337, 338, 339, 356, 372, 397, 400, 326, 327], 329: [330, 331, 333, 334, 335, 336, 337, 370, 371, 372, 375, 400, 327, 328], 330: [331, 332, 333, 334, 335, 336, 337, 369, 370, 371, 372, 375, 328, 329], 331: [332, 333, 334, 335, 371, 372, 328, 329, 330], 332: [333, 334, 335, 330, 331], 333: [334, 335, 336, 368, 369, 370, 371, 329, 330, 331, 332], 334: [335, 336, 337, 369, 396, 399, 400, 328, 329, 330, 331, 332, 333], 335: [336, 337, 358, 359, 367, 368, 369, 370, 371, 372, 396, 400, 328, 329, 330, 331, 332, 333, 334], 336: [337, 338, 358, 359, 360, 367, 368, 369, 370, 371, 372, 375, 327, 328, 329, 330, 333, 334, 335], 337: [338, 339, 356, 357, 358, 359, 393, 396, 397, 400, 327, 328, 329, 330, 334, 335, 336], 338: [339, 340, 341, 353, 354, 355, 356, 357, 358, 359, 397, 325, 326, 327, 328, 336, 337], 339: [340, 341, 355, 356, 357, 397, 400, 401, 325, 326, 327, 328, 337, 338], 340: [341, 342, 343, 355, 324, 325, 326, 338, 339], 341: [342, 343, 344, 345, 347, 348, 353, 354, 355, 324, 325, 326, 338, 339, 340], 342: [343, 344, 345, 346, 347, 348, 322, 324, 325, 326, 340, 341], 343: [344, 345, 346, 347, 348, 349, 324, 340, 341, 342], 344: [345, 346, 347, 348, 349, 324, 341, 342, 343], 345: [346, 347, 348, 349, 350, 321, 322, 323, 324, 325, 341, 342, 343, 344], 346: [347, 348, 349, 350, 316, 317, 318, 321, 322, 323, 324, 325, 342, 343, 344, 345], 347: [348, 349, 350, 351, 352, 353, 314, 316, 322, 323, 324, 325, 341, 342, 343, 344, 345, 346], 348: [349, 350, 351, 353, 324, 341, 342, 343, 344, 345, 346, 347], 349: [350, 351, 316, 343, 344, 345, 346, 347, 348], 350: [351, 352, 353, 314, 315, 316, 345, 346, 347, 348, 349], 351: [352, 353, 354, 314, 347, 348, 349, 350], 352: [353, 354, 388, 390, 312, 314, 315, 316, 347, 350, 351], 353: [354, 356, 357, 388, 390, 312, 314, 316, 325, 338, 341, 347, 348, 350, 351, 352], 354: [355, 356, 357, 392, 411, 412, 307, 308, 338, 341, 351, 352, 353], 355: [356, 357, 392, 394, 397, 401, 412, 338, 339, 340, 341, 354], 356: [357, 358, 391, 392, 393, 394, 395, 396, 397, 398, 412, 328, 337, 338, 339, 353, 354, 355], 357: [358, 359, 390, 391, 392, 393, 394, 397, 312, 337, 338, 339, 353, 354, 355, 356], 358: [359, 360, 361, 367, 368, 389, 390, 391, 392, 393, 396, 335, 336, 337, 338, 356, 357], 359: [360, 361, 362, 367, 368, 375, 379, 388, 389, 390, 391, 325, 327, 335, 336, 337, 338, 357, 358], 360: [361, 362, 366, 367, 368, 388, 389, 390, 391, 311, 336, 358, 359], 361: [362, 363, 364, 365, 366, 367, 368, 387, 388, 389, 390, 358, 359, 360], 362: [363, 364, 365, 366, 367, 375, 378, 379, 382, 386, 387, 388, 389, 359, 360, 361], 363: [364, 365, 378, 379, 382, 383, 385, 386, 387, 388, 361, 362], 364: [365, 366, 367, 387, 389, 361, 362, 363], 365: [366, 367, 378, 361, 362, 363, 364], 366: [367, 368, 369, 370, 360, 361, 362, 364, 365], 367: [368, 369, 370, 371, 374, 375, 378, 379, 335, 336, 358, 359, 360, 361, 362, 364, 365, 366], 368: [369, 370, 333, 335, 336, 358, 359, 360, 361, 366, 367], 369: [370, 371, 330, 333, 334, 335, 336, 366, 367, 368], 370: [371, 372, 374, 375, 329, 330, 333, 335, 336, 366, 367, 368, 369], 371: [372, 373, 374, 375, 376, 329, 330, 331, 333, 335, 336, 367, 369, 370], 372: [373, 374, 375, 376, 327, 328, 329, 330, 331, 335, 336, 370, 371], 373: [374, 375, 376, 377, 371, 372], 374: [375, 376, 377, 378, 367, 370, 371, 372, 373], 375: [376, 377, 378, 379, 380, 327, 329, 330, 336, 359, 362, 367, 370, 371, 372, 373, 374], 376: [377, 378, 379, 380, 381, 327, 371, 372, 373, 374, 375], 377: [378, 379, 380, 381, 382, 373, 374, 375, 376], 378: [379, 380, 381, 382, 383, 362, 363, 365, 367, 374, 375, 376, 377], 379: [380, 381, 382, 383, 386, 388, 323, 325, 327, 359, 362, 363, 367, 375, 376, 377, 378], 380: [381, 382, 383, 322, 323, 375, 376, 377, 378, 379], 381: [382, 383, 376, 377, 378, 379, 380], 382: [383, 384, 385, 386, 387, 318, 362, 363, 377, 378, 379, 380, 381], 383: [384, 385, 386, 318, 319, 320, 323, 363, 378, 379, 380, 381, 382], 384: [385, 386, 317, 318, 319, 320, 321, 382, 383], 385: [386, 387, 315, 316, 317, 318, 319, 363, 382, 383, 384], 386: [387, 388, 314, 315, 316, 317, 318, 319, 323, 362, 363, 379, 382, 383, 384, 385], 387: [388, 389, 313, 314, 315, 316, 361, 362, 363, 364, 382, 385, 386], 388: [389, 390, 312, 313, 314, 315, 316, 352, 353, 359, 360, 361, 362, 363, 379, 386, 387], 389: [390, 391, 311, 312, 313, 314, 358, 359, 360, 361, 362, 364, 387, 388], 390: [391, 392, 310, 311, 312, 313, 314, 352, 353, 357, 358, 359, 360, 361, 388, 389], 391: [392, 393, 308, 309, 310, 311, 312, 356, 357, 358, 359, 360, 389, 390], 392: [393, 394, 395, 397, 410, 411, 412, 307, 308, 309, 312, 354, 355, 356, 357, 358, 390, 391], 393: [394, 395, 396, 397, 309, 337, 356, 357, 358, 391, 392], 394: [395, 396, 397, 398, 406, 410, 411, 412, 307, 309, 355, 356, 357, 392, 393], 395: [396, 397, 398, 399, 406, 410, 412, 309, 356, 392, 393, 394], 396: [397, 398, 399, 400, 334, 335, 337, 356, 358, 393, 394, 395], 397: [398, 399, 400, 401, 404, 412, 328, 337, 338, 339, 355, 356, 357, 392, 393, 394, 395, 396], 398: [399, 400, 401, 402, 404, 405, 406, 412, 413, 356, 394, 395, 396, 397], 399: [400, 334, 395, 396, 397, 398], 400: [401, 402, 404, 328, 329, 334, 335, 337, 339, 396, 397, 398, 399], 401: [402, 403, 404, 412, 414, 339, 355, 397, 398, 400], 402: [403, 404, 414, 415, 398, 400, 401], 403: [404, 405, 413, 414, 415, 401, 402], 404: [405, 406, 412, 413, 414, 415, 397, 398, 400, 401, 402, 403], 405: [406, 407, 412, 413, 414, 415, 398, 403, 404], 406: [407, 408, 409, 410, 411, 412, 413, 394, 395, 398, 404, 405], 407: [408, 409, 410, 411, 412, 413, 303, 405, 406], 408: [409, 410, 411, 304, 306, 406, 407], 409: [410, 411, 303, 304, 305, 306, 307, 406, 407, 408], 410: [411, 412, 413, 306, 307, 309, 392, 394, 395, 406, 407, 408, 409], 411: [412, 413, 303, 304, 305, 306, 307, 354, 392, 394, 406, 407, 408, 409, 410], 412: [413, 414, 354, 355, 356, 392, 394, 395, 397, 398, 401, 404, 405, 406, 407, 410, 411], 413: [414, 415, 398, 403, 404, 405, 406, 407, 410, 411, 412], 414: [415, 401, 402, 403, 404, 405, 412, 413], 415: [402, 403, 404, 405, 413, 414]}

# Distance criterion < 6 Ã… - using nativecontacts (Amber14) - min distance between all atoms in each residue
real_alldict = {301: [302, 303, 304, 305, 411], 302: [303, 304, 305, 306, 409, 411, 301],
 303: [304, 305, 307, 407, 409, 411, 301, 302], 304: [305, 306, 407, 409, 411, 301, 302, 303], 305: [306, 307, 308, 409, 411, 301, 302, 303, 304], 306: [307, 308, 309, 408, 409, 410, 411, 302, 304, 305], 307: [308, 309, 310, 312, 354, 355, 357, 392, 394, 406, 407, 409, 410, 411, 412, 303, 305, 306], 308: [309, 310, 312, 354, 391, 392, 305, 306, 307], 309: [310, 311, 312, 391, 392, 393, 394, 395, 396, 406, 407, 408, 409, 410, 411, 306, 307, 308], 310: [311, 312, 390, 391, 392, 307, 308, 309], 311: [312, 313, 360, 389, 390, 391, 392, 393, 309, 310], 312: [313, 314, 338, 352, 353, 354, 357, 358, 360, 388, 389, 390, 391, 392, 393, 307, 308, 309, 310, 311], 313: [314, 315, 352, 387, 388, 389, 390, 311, 312], 314: [315, 316, 338, 347, 350, 352, 353, 357, 359, 386, 387, 388, 389, 390, 391, 312, 313], 315: [316, 317, 350, 352, 385, 386, 387, 388, 313, 314], 316: [317, 318, 319, 322, 323, 325, 346, 347, 348, 349, 350, 352, 353, 384, 385, 386, 387, 388, 314, 315], 317: [318, 319, 321, 323, 346, 350, 384, 385, 386, 315, 316], 318: [319, 320, 321, 322, 323, 324, 346, 347, 362, 363, 378, 379, 380, 381, 382, 383, 384, 385, 386, 316, 317], 319: [320, 321, 383, 384, 385, 386, 316, 317, 318], 320: [321, 322, 383, 384, 318, 319], 321: [322, 323, 324, 346, 384, 317, 318, 319, 320], 322: [323, 324, 325, 345, 346, 347, 380, 316, 318, 320, 321], 323: [324, 325, 341, 342, 345, 346, 347, 348, 353, 362, 378, 379, 380, 382, 383, 384, 385, 386, 388, 316, 317, 318, 321, 322], 324: [325, 326, 340, 341, 342, 343, 344, 345, 346, 347, 348, 318, 321, 322, 323], 325: [326, 327, 336, 337, 338, 339, 340, 341, 342, 345, 346, 347, 348, 353, 359, 362, 379, 386, 388, 316, 322, 323, 324], 326: [327, 328, 337, 338, 339, 340, 341, 342, 324, 325], 327: [328, 329, 330, 336, 337, 338, 339, 340, 359, 367, 371, 372, 373, 375, 376, 377, 379, 397, 325, 326], 328: [329, 330, 331, 334, 335, 336, 337, 338, 339, 340, 355, 356, 372, 396, 397, 400, 401, 326, 327], 329: [330, 331, 334, 335, 336, 337, 370, 371, 372, 375, 400, 327, 328], 330: [331, 332, 333, 334, 335, 336, 337, 367, 368, 369, 370, 371, 372, 373, 375, 400, 327, 328, 329], 331: [332, 333, 334, 335, 336, 370, 371, 372, 400, 328, 329, 330], 332: [333, 334, 335, 369, 371, 372, 330, 331], 333: [334, 335, 336, 337, 358, 368, 369, 370, 371, 330, 331, 332], 334: [335, 336, 337, 358, 368, 369, 396, 399, 400, 328, 329, 330, 331, 332, 333], 335: [336, 337, 358, 359, 367, 368, 369, 370, 400, 328, 329, 330, 331, 332, 333, 334], 336: [337, 338, 357, 358, 359, 360, 367, 368, 369, 370, 371, 372, 373, 375, 376, 379, 400, 325, 327, 328, 329, 330, 331, 333, 334, 335], 337: [338, 339, 340, 355, 356, 357, 358, 359, 391, 392, 393, 394, 396, 397, 400, 325, 326, 327, 328, 329, 330, 333, 334, 335, 336], 338: [339, 340, 341, 347, 353, 354, 355, 356, 357, 358, 359, 379, 388, 390, 397, 412, 312, 314, 325, 326, 327, 328, 336, 337], 339: [340, 341, 354, 355, 356, 357, 397, 400, 401, 412, 325, 326, 327, 328, 337, 338], 340: [341, 342, 343, 347, 355, 356, 397, 324, 325, 326, 327, 328, 337, 338, 339], 341: [342, 343, 344, 345, 347, 348, 349, 350, 351, 352, 353, 354, 355, 357, 323, 324, 325, 326, 338, 339, 340], 342: [343, 344, 345, 346, 347, 348, 349, 323, 324, 325, 326, 340, 341], 343: [344, 345, 348, 349, 324, 340, 341, 342], 344: [345, 346, 348, 349, 324, 341, 342, 343], 345: [346, 347, 348, 349, 350, 351, 322, 323, 324, 325, 341, 342, 343, 344], 346: [347, 348, 349, 350, 351, 352, 353, 316, 317, 318, 321, 322, 323, 324, 325, 342, 344, 345], 347: [348, 349, 350, 351, 352, 353, 388, 314, 316, 318, 322, 323, 324, 325, 338, 340, 341, 342, 345, 346], 348: [349, 350, 351, 352, 353, 316, 323, 324, 325, 341, 342, 343, 344, 345, 346, 347], 349: [350, 351, 352, 316, 341, 342, 343, 344, 345, 346, 347, 348], 350: [351, 352, 353, 314, 315, 316, 317, 341, 345, 346, 347, 348, 349], 351: [352, 353, 341, 345, 346, 347, 348, 349, 350], 352: [353, 354, 357, 390, 312, 313, 314, 315, 316, 341, 346, 347, 348, 349, 350, 351], 353: [354, 355, 357, 359, 388, 389, 390, 312, 314, 316, 323, 325, 338, 341, 346, 347, 348, 350, 351, 352], 354: [355, 356, 357, 358, 390, 392, 394, 410, 411, 412, 307, 308, 312, 338, 339, 341, 352, 353], 355: [356, 357, 392, 393, 394, 397, 398, 401, 404, 412, 413, 414, 307, 328, 337, 338, 339, 340, 341, 353, 354], 356: [357, 358, 391, 392, 393, 394, 396, 397, 398, 400, 412, 328, 337, 338, 339, 340, 354, 355], 357: [358, 359, 388, 390, 391, 392, 393, 394, 397, 412, 307, 312, 314, 336, 337, 338, 339, 341, 352, 353, 354, 355, 356], 358: [359, 360, 361, 367, 368, 369, 370, 388, 389, 390, 391, 392, 393, 396, 397, 312, 333, 334, 335, 336, 337, 338, 354, 356, 357], 359: [360, 361, 362, 365, 367, 368, 375, 379, 388, 389, 390, 391, 314, 325, 327, 335, 336, 337, 338, 353, 357, 358], 360: [361, 362, 365, 366, 367, 368, 369, 388, 389, 390, 391, 393, 311, 312, 336, 358, 359], 361: [362, 363, 364, 365, 366, 367, 368, 379, 386, 387, 388, 389, 390, 358, 359, 360], 362: [363, 364, 365, 366, 367, 375, 378, 379, 380, 382, 386, 387, 388, 389, 318, 323, 325, 359, 360, 361], 363: [364, 365, 378, 381, 382, 383, 384, 385, 386, 387, 388, 389, 318, 361, 362], 364: [365, 366, 387, 388, 389, 361, 362, 363], 365: [366, 367, 368, 370, 378, 387, 359, 360, 361, 362, 363, 364], 366: [367, 368, 369, 370, 360, 361, 362, 364, 365], 367: [368, 369, 370, 371, 374, 375, 376, 378, 379, 388, 327, 330, 335, 336, 358, 359, 360, 361, 362, 365, 366], 368: [369, 370, 330, 333, 334, 335, 336, 358, 359, 360, 361, 365, 366, 367], 369: [370, 371, 330, 332, 333, 334, 335, 336, 358, 360, 366, 367, 368], 370: [371, 372, 374, 375, 376, 378, 329, 330, 331, 333, 335, 336, 358, 365, 366, 367, 368, 369], 371: [372, 373, 374, 375, 376, 327, 329, 330, 331, 332, 333, 336, 367, 369, 370], 372: [373, 374, 375, 376, 377, 378, 327, 328, 329, 330, 331, 332, 336, 370, 371], 373: [374, 375, 376, 377, 378, 379, 380, 327, 330, 336, 371, 372], 374: [375, 376, 377, 378, 379, 381, 367, 370, 371, 372, 373], 375: [376, 377, 378, 379, 380, 381, 327, 329, 330, 336, 359, 362, 367, 370, 371, 372, 373, 374], 376: [377, 378, 379, 380, 381, 382, 327, 336, 367, 370, 371, 372, 373, 374, 375], 377: [378, 379, 380, 381, 382, 327, 372, 373, 374, 375, 376], 378: [379, 380, 381, 382, 383, 386, 318, 323, 362, 363, 365, 367, 370, 372, 373, 374, 375, 376, 377], 379: [380, 381, 382, 383, 386, 388, 318, 323, 325, 327, 336, 338, 359, 361, 362, 367, 373, 374, 375, 376, 377, 378], 380: [381, 382, 383, 318, 322, 323, 362, 373, 375, 376, 377, 378, 379], 381: [382, 383, 318, 363, 374, 375, 376, 377, 378, 379, 380], 382: [383, 384, 385, 386, 387, 388, 318, 323, 362, 363, 376, 377, 378, 379, 380, 381], 383: [384, 385, 386, 318, 319, 320, 323, 363, 378, 379, 380, 381, 382], 384: [385, 386, 316, 317, 318, 319, 320, 321, 323, 363, 382, 383], 385: [386, 387, 315, 316, 317, 318, 319, 323, 363, 382, 383, 384], 386: [387, 388, 314, 315, 316, 317, 318, 319, 323, 325, 361, 362, 363, 378, 379, 382, 383, 384, 385], 387: [388, 389, 313, 314, 315, 316, 361, 362, 363, 364, 365, 382, 385, 386], 388: [389, 390, 391, 312, 313, 314, 315, 316, 323, 325, 338, 347, 353, 357, 358, 359, 360, 361, 362, 363, 364, 367, 379, 382, 386, 387], 389: [390, 391, 311, 312, 313, 314, 353, 358, 359, 360, 361, 362, 363, 364, 387, 388], 390: [391, 392, 310, 311, 312, 313, 314, 338, 352, 353, 354, 357, 358, 359, 360, 361, 388, 389], 391: [392, 393, 394, 308, 309, 310, 311, 312, 314, 337, 356, 357, 358, 359, 360, 388, 389, 390], 392: [393, 394, 395, 397, 406, 407, 409, 410, 411, 412, 307, 308, 309, 310, 311, 312, 337, 354, 355, 356, 357, 358, 390, 391], 393: [394, 395, 396, 397, 398, 406, 412, 309, 311, 312, 337, 355, 356, 357, 358, 360, 391, 392], 394: [395, 396, 397, 398, 399, 405, 406, 407, 409, 410, 411, 412, 307, 309, 337, 354, 355, 356, 357, 391, 392, 393], 395: [396, 397, 398, 399, 400, 405, 406, 407, 410, 412, 309, 392, 393, 394], 396: [397, 398, 399, 400, 406, 309, 328, 334, 337, 356, 358, 393, 394, 395], 397: [398, 399, 400, 401, 404, 406, 412, 414, 327, 328, 337, 338, 339, 340, 355, 356, 357, 358, 392, 393, 394, 395, 396], 398: [399, 400, 401, 402, 404, 405, 406, 412, 413, 355, 356, 393, 394, 395, 396, 397], 399: [400, 401, 402, 404, 334, 394, 395, 396, 397, 398], 400: [401, 402, 404, 328, 329, 330, 331, 334, 335, 336, 337, 339, 356, 395, 396, 397, 398, 399], 401: [402, 403, 404, 412, 414, 328, 339, 355, 397, 398, 399, 400], 402: [403, 404, 414, 415, 398, 399, 400, 401], 403: [404, 405, 413, 414, 415, 401, 402], 404: [405, 406, 412, 413, 414, 415, 355, 397, 398, 399, 400, 401, 402, 403], 405: [406, 407, 408, 411, 412, 413, 414, 415, 394, 395, 398, 403, 404], 406: [407, 408, 409, 410, 411, 412, 413, 307, 309, 392, 393, 394, 395, 396, 397, 398, 404, 405], 407: [408, 409, 410, 411, 412, 413, 303, 304, 307, 309, 392, 394, 395, 405, 406], 408: [409, 410, 411, 306, 309, 405, 406, 407], 409: [410, 411, 412, 302, 303, 304, 305, 306, 307, 309, 392, 394, 406, 407, 408], 410: [411, 412, 306, 307, 309, 354, 392, 394, 395, 406, 407, 408, 409], 411: [412, 413, 301, 302, 303, 304, 305, 306, 307, 309, 354, 392, 394, 405, 406, 407, 408, 409, 410], 412: [413, 414, 307, 338, 339, 354, 355, 356, 357, 392, 393, 394, 395, 397, 398, 401, 404, 405, 406, 407, 409, 410, 411], 413: [414, 415, 355, 398, 403, 404, 405, 406, 407, 411, 412], 414: [415, 355, 397, 401, 402, 403, 404, 405, 412, 413], 415: [402, 403, 404, 405, 413, 414]}


def distance(pointA, pointB):
    x = pointA[0] - pointB[0]
    y = pointA[1] - pointB[1]
    z = pointA[2] - pointB[2]
    dist = np.sqrt(x**2 + y**2 + z**2)
    return dist


def gathering():
    global res_dict
    threshold = 6
    alldict = {}
    random.seed()
    handful = random.sample(list(res_dict2), 21)
    handful.insert(0, 313)
    handful.append(376)
    for i in handful:
        templist = []
        for j in handful:
            if i == j:
                continue
            if distance(res_dict[i], res_dict[j]) < threshold:
                templist.append(j)
        alldict[i] = templist
    return handful, alldict

def real_gathering():
    global res_dict, real_alldict
    threshold = 6
    random.seed()
    real_handful = random.sample(list(res_dict2), 21)
    real_handful.insert(0, 313)
    real_handful.append(376)
    bad_apples = set(range(301,416)) - set(real_handful)
    for res in real_handful:
        real_alldict[res] = list(set(real_alldict[res])- bad_apples)
    return real_handful, real_alldict


def DFS3(current): # takes a point input
    global alldict, handful, res_dict, failure
    # print('current node: ', current)
    path.append(current)    # add current point to path
    if alldict[current] == []: # check that it has options
        failure += 1
        return print('failed', path)
    current = list(set(alldict[current]) - set(path))  # make current now the options for that point, excluding path
    # print('current branchs: ', current)
    if current == []:
        failure += 1
        return print('failed', path)
    puma = 10000000 # set an arbitrarily large initial threshold
    tiger = 0 # initialize the position holder
    for i in range(0,len(current)): # loop through the options
        leopard = distance(res_dict[current[i]], res_dict[handful[-1]]) # check distance of option to end point
        if leopard < puma:
            puma = leopard # if it's closer, make it new threshold
            tiger = i # save its position
    if current[tiger] == (handful[-1]): # check if it's the end point
        path.append((handful[-1]))
        return print('succeed', path)
    next_current = current[tiger] # new variable name for the best choice
    # current = list(set(alldict[current[tiger]]) - set(path))
    # if current == []:
    #     return 'failed', path
    DFS3(next_current) # recurse to the next step with as a point

# z = 0
def real_DFS3(current): # takes a point input
    global real_alldict, real_handful, res_dict, failure
    # global z
    # print('current node: ', current)
    path.append(current)    # add current point to path
    if real_alldict[current] == []: # check that it has options
        failure += 1
        # z += 1
        # print("FAILED HERE", z)
        return print('failed', path)
    current = list(set(real_alldict[current]) - set(path))  # make current now the options for that point, excluding path
    # print('current branchs: ', current)
    if current == []:
        failure += 1
        return print('failed', path)
    puma = 10000000 # set an arbitrarily large initial threshold
    tiger = 0 # initialize the position holder
    for i in range(0,len(current)): # loop through the options
        leopard = distance(res_dict[current[i]], res_dict[real_handful[-1]]) # check distance of option to end point
        if leopard < puma:
            puma = leopard # if it's closer, make it new threshold
            tiger = i # save its position
    if current[tiger] == (real_handful[-1]): # check if it's the end point
        path.append((real_handful[-1]))
        return print('succeed', path)
    next_current = current[tiger] # new variable name for the best choice
    # current = list(set(alldict[current[tiger]]) - set(path))
    # if current == []:
    #     return 'failed', path
    real_DFS3(next_current) # recurse to the next step with as a point


def DFS4(current): # takes a point input
    global alldict, handful, res_dict, failure
    # print('current node: ', current)
    path.append(current)    # add current point to path
    if alldict[current] == []: # check that it has options
        failure += 1
        return #failed
    current = list(set(alldict[current]) - set(path))  # make current now the options for that point, excluding path
    # print('current branchs: ', current)
    if current == []:
        failure += 1
        return  # failed
    puma = 10000000 # set an arbitrarily large initial threshold
    tiger = 0 # initialize the position holder
    for i in range(0,len(current)): # loop through the options
        leopard = distance(res_dict[current[i]], res_dict[handful[-1]]) # check distance of option to end point
        if leopard < puma:
            puma = leopard # if it's closer, make it new threshold
            tiger = i # save its position
    if current[tiger] == (handful[-1]): # check if it's the end point
        path.append((handful[-1]))
        return # succeed
    next_current = current[tiger] # new variable name for the best choice
    # current = list(set(alldict[current[tiger]]) - set(path))
    # if current == []:
    #     return 'failed', path
    DFS4(next_current) # recurse to the next step with as a point

def letsgo():
    global res_dict, alldict, handful, path, failure
    handful, alldict = gathering()
    path = []
    if alldict[handful[0]] == []:
        failure += 1
        return print('failed start')
    if alldict[handful[-1]] == []:
        failure += 1
        return print('failed end')
    DFS3(313)

def real_letsgo():
    global res_dict, real_alldict, real_handful, path, failure
    real_handful, real_alldict = real_gathering()
    path = []
    if real_alldict[real_handful[0]] == []:
        failure += 1
        return print('failed start')
    if real_alldict[real_handful[-1]] == []:
        failure += 1
        return print('failed end')
    real_DFS3(313)

def letsgo2():
    global res_dict, alldict, handful, path, failure
    handful, alldict = gathering()
    path = []
    if alldict[handful[0]] == []:
        failure += 1
        return print('failed start')
    if alldict[handful[-1]] == []:
        failure += 1
        return print('failed end')
    DFS4(313)
    f.write(str(failure))


# f = open('~/allostery/failure.txt', 'w')
# failure = 0
# n = 500
# for i in range(0,n):
#     letsgo()
# print('success: ', (n - failure))
# print('success rate: ', str(100*float((n - failure)/n))+"%")
# f.close()


failure = 0
n = 1000
for i in range(0,n):
    real_letsgo()
print("\n", n, "trials")
print('successes: ', (n - failure))
print('success rate: ', str(100*float((n - failure)/n))+"%")
print(real_alldict)

# failure = 0
# n = 5000
# for i in range(0,n):
#         letsgo()
# print("\n", n, "trials")
# print('success: ', (n - failure))
# print('success rate: ', str(100*float((n - failure)/n))+"%")
# print('success rate: ', str(100*float((n - failure)/n))+"%")







print("--- %s seconds ---" % (time.time() - start_time))
# bottom
